(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{568:function(n,s,t){"use strict";t.r(s);var a=t(3),e=Object(a.a)({},(function(){var n=this,s=n.$createElement,t=n._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h2",{attrs:{id:"_1-nginx上传文件大小限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx上传文件大小限制"}},[n._v("#")]),n._v(" 1. nginx上传文件大小限制")]),n._v(" "),t("p",[n._v("需要在nginx.conf文件中设置"),t("code",[n._v("client_max_body_size")]),n._v("参数的大小，设置100M 代表上传文件大小最大为100M")]),n._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[n._v("client_max_body_size     "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("50")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[n._v("//文件大小限制，默认1m")]),n._v("\n\nclient_header_timeout    "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\nclient_body_timeout      "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\nproxy_connect_timeout     "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("60")]),n._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\nproxy_read_timeout      "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\nproxy_send_timeout      "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br")])]),t("p",[n._v("每个参数的意思：")]),n._v(" "),t("p",[n._v("client_max_body_size")]),n._v(" "),t("p",[n._v("限制请求体的大小，若超过所设定的大小，返回413错误。")]),n._v(" "),t("p",[n._v("client_header_timeout")]),n._v(" "),t("p",[n._v("读取请求头的超时时间，若超过所设定的大小，返回408错误。")]),n._v(" "),t("p",[n._v("client_body_timeout")]),n._v(" "),t("p",[n._v("读取请求实体的超时时间，若超过所设定的大小，返回413错误。")]),n._v(" "),t("p",[n._v("proxy_connect_timeout")]),n._v(" "),t("p",[n._v("http请求无法立即被容器(tomcat, netty等)处理，被放在nginx的待处理池中等待被处理。此参数为等待的最长时间，默认为60秒，官方推荐最长不要超过75秒。")]),n._v(" "),t("p",[n._v("proxy_read_timeout")]),n._v(" "),t("p",[n._v("http请求被容器(tomcat, netty等)处理后，nginx会等待处理结果，也就是容器返回的response。此参数即为服务器响应时间，默认60秒。")]),n._v(" "),t("p",[n._v("proxy_send_timeout")]),n._v(" "),t("p",[n._v("http请求被服务器处理完后，把数据传返回给Nginx的用时，默认60秒。")]),n._v(" "),t("p",[n._v("nginx.conf")]),n._v(" "),t("p",[n._v("在nginx使用过程中，上传文件的过程中，通常需要设置nginx报文大小限制。避免出现413 Request Entity Too Large。")]),n._v(" "),t("p",[n._v("于是奇葩的问题被我们遇到了，详细配置请参考下面。我们的问题是，无论client_max_body_size设置在哪里，nginx －s reload后，依然一直报413.多次尝试reload，始终无效。最终决定kill 进程，restart，终于好了。")]),n._v(" "),t("p",[n._v("由此可见，nginx reload并不一定好使。有时候，为了保险起见。restart比较靠谱。不知道别人有没有遇到同样的问题。希望对大家有帮助！～～")]),n._v(" "),t("h2",{attrs:{id:"三个位置设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三个位置设置"}},[n._v("#")]),n._v(" 三个位置设置")]),n._v(" "),t("p",[n._v("可以选择在http{ }中设置：client_max_body_size   20m;")]),n._v(" "),t("p",[n._v("也可以选择在server{ }中设置：client_max_body_size   20m;")]),n._v(" "),t("p",[n._v("还可以选择在location{ }中设置：client_max_body_size   20m;")]),n._v(" "),t("p",[n._v("三者到区别是：http{} 中控制着所有nginx收到的请求。而报文大小限制设置在server｛｝中，则控制该server收到的请求报文大小，同理，如果配置在location中，则报文大小限制，只对匹配了location 路由规则的请求生效。")]),n._v(" "),t("p",[n._v("可以选择在http{ }中设置：client_max_body_size   20m;")]),n._v(" "),t("p",[n._v("也可以选择在server{ }中设置：client_max_body_size   20m;")]),n._v(" "),t("p",[n._v("还可以选择在location{ }中设置：client_max_body_size   20m;")]),n._v(" "),t("p",[n._v("三者到区别是：http{} 中控制着所有nginx收到的请求。而报文大小限制设置在server｛｝中，则控制该server收到的请求报文大小，同理，如果配置在location中，则报文大小限制，只对匹配了location 路由规则的请求生效。")]),n._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[n._v("     http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\n#控制全局nginx所有请求报文大小\n\n#client_max_body_size   "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("20")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n                server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\n#控制该server的所有请求报文大小\n\n#client_max_body_size   "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("20")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n                        location a "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\n                        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n                        location b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\n#控制满足该路由规则的请求报文大小\n\n#client_max_body_size   "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("20")]),n._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n                        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n                server "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);