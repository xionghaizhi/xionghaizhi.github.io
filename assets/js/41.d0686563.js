(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{538:function(s,a,t){"use strict";t.r(a);var r=t(3),n=Object(r.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("Boxx"),s._v(" "),t("p",[s._v("因为服务器不在同一个局域网内，需要将nacos服务注册地址改为公网ip。"),t("br"),s._v("\n我采用docker部署的，具体修改如下：")]),s._v(" "),t("ol",[t("li",[s._v("修改服务配置文件")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("spring"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  application"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@artifactId")]),s._v("@\n  cloud"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    nacos"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      discovery"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      # 指定注册nacos服务ip地址，此处留空，动态设置。\n        ip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("修改Dockerfile文件，xxl-job也可以指定设置注册地址，此处dockerfile中就一起配置了xxl-job的信息，xxl-job配置文件在文章最后")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("CMD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java $JAVA_OPTS -jar xionghaizhi-biz.jar --spring.cloud.nacos.discovery.ip=$client_ip --xxl.job.executor.ip=$client_ip"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("修改docker run启动命令")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"always"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("P")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e client_ip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"公网地址ip"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name xionghaizhi xionghaiz"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pkg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("coding"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xionghaizhi"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xionghaizhi"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xionghaizhi"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/zimou5581/article/details/91041239",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考CSDN"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("xxl-job配置文件修改")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("xxl"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  job"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    executor"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      # 指定注册服务ip地址，此处留空，动态设置。\n      ip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])],1)}),[],!1,null,null,null);a.default=n.exports}}]);